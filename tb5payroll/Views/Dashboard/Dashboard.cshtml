@{
	Layout = "_DashboardLayout";
	ViewBag.Title = "Dashboard";
}

<h2 class="text-left mb-3 fs-4 fw-bold">Employee Dashboard</h2>

<<<<<<< HEAD
<!-- Search Bar & Controls -->
<div class="d-flex justify-content-between align-items-center p-2 shadow-sm rounded bg-light border">
	<input type="text" id="searchInput" class="form-control form-control-sm w-25 border-primary"
		   placeholder="🔍 Search Employee..." onkeyup="searchEmployee()">

	<button class="btn btn-sm btn-primary px-3">
		<i class="bi bi-printer"></i> Print All
	</button>

	<select class="form-select form-select-sm w-25 border-primary">
		<option>📂 Choose Excel File</option>
=======
<!-- Search Bar -->
<div class="mb-3 d-flex justify-content-between">
	<input type="text" id="searchInput" class="form-control w-25" placeholder="Search Employee..." onkeyup="searchEmployee()">
	<button class="btn btn-primary">Print All</button>
	<input type="file" id="excelFileInput" class="form-control w-25" accept=".xlsx" />
	<select id="sheetSelect" class="form-select w-25" disabled>
		<option>Choose Sheet</option>
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
	</select>
</div>

<!-- Employee Table -->
<div class="table-responsive" style="max-height: 370px; overflow-y: auto; border: 1px solid #ccc;">
	<table class="table table-sm table-bordered text-center" id="employeeTable" style="margin-bottom: 0; font-size: 17px;">
		<thead class="table-dark" style="background-color: skyblue;">
<<<<<<< HEAD
			<tr>
				<th style="z-index: 2; background: skyblue;">ID No</th>
				<th style="z-index: 2; background: skyblue;">Name</th>
				<th style="z-index: 2; background: skyblue;">Department</th>
				<th style="z-index: 2; background: skyblue;">Holiday</th>
				<th style="z-index: 2; background: skyblue;">Overtime</th>
				<th style="z-index: 2; background: skyblue;">Hours Worked</th>
				<th style="z-index: 2; background: skyblue;">Actions</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>33847834</td>
				<td><a>John Doe</a></td>
				<td>TB5 STAFF</td>
				<td>10</td>
				<td>20</td>
				<td>110</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>433834</td>
				<td><a>Jane Doe</a></td>
				<td>TB5 STAFF</td>
				<td>12</td>
				<td>20</td>
				<td>98</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>2277834</td>
				<td><a>Johnny Sins</a></td>
				<td>TB5 STAFF</td>
				<td>13</td>
				<td>22</td>
				<td>115</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>33847834</td>
				<td><a>John Doe</a></td>
				<td>TB5 STAFF</td>
				<td>10</td>
				<td>20</td>
				<td>110</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>433834</td>
				<td><a>Jane Doe</a></td>
				<td>TB5 STAFF</td>
				<td>12</td>
				<td>20</td>
				<td>98</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>2277834</td>
				<td><a>Johnny Sins</a></td>
				<td>TB5 STAFF</td>
				<td>13</td>
				<td>22</td>
				<td>115</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>33847834</td>
				<td><a>John Doe</a></td>
				<td>TB5 STAFF</td>
				<td>10</td>
				<td>20</td>
				<td>110</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>433834</td>
				<td><a>Jane Doe</a></td>
				<td>TB5 STAFF</td>
				<td>12</td>
				<td>20</td>
				<td>98</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>2277834</td>
				<td><a>Johnny Sins</a></td>
				<td>TB5 STAFF</td>
				<td>13</td>
				<td>22</td>
				<td>115</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>33847834</td>
				<td><a>John Doe</a></td>
				<td>TB5 STAFF</td>
				<td>10</td>
				<td>20</td>
				<td>110</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>433834</td>
				<td><a>Jane Doe</a></td>
				<td>TB5 STAFF</td>
				<td>12</td>
				<td>20</td>
				<td>98</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
			<tr>
				<td>2277834</td>
				<td><a>Johnny Sins</a></td>
				<td>TB5 STAFF</td>
				<td>13</td>
				<td>22</td>
				<td>115</td>
				<td>
					<button class="btn btn-primary btn-view">View</button>
					<button class="btn btn-danger btn-delete">Delete</button>
				</td>
			</tr>
=======
		<tr>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">ID No</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Name</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Department</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Holiday</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Overtime</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Hours Worked</th>
			<th style="position: sticky; top: 0; z-index: 2; background: skyblue;">Actions</th>
		</tr>
		</thead>
		<tbody>
		<!-- Rows will be populated dynamically -->
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
		</tbody>
	</table>
</div>

<!-- Modal -->
<div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="detailsModalLabel">Employee Deeets</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<!-- Updated Details Table -->
				<table class="table table-bordered">
<<<<<<< HEAD
					<thead class="table-dark">
						<tr>
							<th>Overtime</th>
							<th>Min</th>
							<th>Pay</th>
							<th>Deduction</th>
							<th>Amount</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Regular</td>
							<td><span id="payslipMinutes">62.50</span></td>
							<td>0.00</td>
							<td>W/H Tax</td>
							<td><span id="payslipTax">0.00</span></td>
						</tr>
						<tr>
							<td>Training</td>
							<td><span id="payslipTrainingMinutes">1000.00</span></td>
							<td>0.00</td>
							<td>SSS</td>
							<td><span id="payslipSSS">0.00</span></td>
						</tr>
						<tr>
							<td colspan="3" class="text-center"><strong>TRAINING DETAILS</strong></td>
							<td>PAG-IBIG</td>
							<td><span id="payslipPagIbig">0.00</span></td>
						</tr>
						<tr>
							<td>Batch/s</td>
							<td>Days</td>
							<td>Training Dates</td>
							<td>Tardiness</td>
							<td><span id="payslipTardiness">0.00</span></td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
							<td>Loan</td>
							<td><span id="payslipLoan">0.00</span></td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
							<td>Others / C.A.</td>
							<td><span id="payslipOthers">0.00</span></td>
						</tr>
=======
					<thead class="table-light">
					<tr>
						<th>Employee Information</th>
						<th>Details</th>
					</tr>
					</thead>
					<tbody id="detailsTableBody">
					<!-- Dynamic content will be inserted here -->
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
					</tbody>
				</table>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
<<<<<<< HEAD
				<button type="button" class="btn btn-primary btn-print" data-modal="payslipModal">Print</button>
=======
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
			</div>
		</div>
	</div>
</div>

<<<<<<< HEAD

<!-- 2nd Cutoff Modal -->
<!-- 2nd Cutoff Modal -->
<div class="modal fade" id="payslipModalSecond" tabindex="-1" aria-labelledby="payslipModalSecondLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">

			<div class="modal-header">
				<h5 class="modal-title" id="payslipTitleSecond">Payslip - Semi-Monthly Payroll (2nd Cut-off: 16th - 30th/31st)</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<h4 class="text-center">THE BIG FIVE TRAINING AND ASSESSMENT CENTER</h4>
				<div><strong>Employee:</strong> <span id="payslipEmployeeName">John Doe</span></div>

				<table class="table table-bordered">
					<thead class="table-dark">
						<tr>
							<th>Overtime</th>
							<th>Min</th>
							<th>Pay</th>
							<th>Deduction</th>
							<th>Amount</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>Regular</td>
							<td><span id="payslipMinutes">62.50</span></td>
							<td>0.00</td>
							<td>W/H Tax</td>
							<td><span id="payslipTax">0.00</span></td>
						</tr>
						<tr>
							<td>Training</td>
							<td><span id="payslipTrainingMinutes">1000.00</span></td>
							<td>0.00</td>
							<td>SSS</td>
							<td><span id="payslipSSS">0.00</span></td>
						</tr>
						<tr>
							<td colspan="3" class="text-center"><strong>TRAINING DETAILS</strong></td>
							<td>PAG-IBIG</td>
							<td><span id="payslipPagIbig">0.00</span></td>
						</tr>
						<tr>
							<td>Batch/s</td>
							<td>Days</td>
							<td>Training Dates</td>
							<td>Tardiness</td>
							<td><span id="payslipTardiness">0.00</span></td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
							<td>Loan</td>
							<td><span id="payslipLoan">0.00</span></td>
						</tr>
						<tr>
							<td></td>
							<td></td>
							<td></td>
							<td>Others / C.A.</td>
							<td><span id="payslipOthers">0.00</span></td>
						</tr>
					</tbody>
				</table>

				<div>
					<strong>Deduction:</strong> <span id="payslipTotalDeduction">0.00</span><br>
					<strong>Overtime:</strong> <span id="payslipOvertime">0.00</span><br>
					<strong>Training:</strong> <span id="payslipTraining">0.00</span><br>
					<strong>Gross Pay:</strong> <span id="payslipGrossPay">0.00</span><br>
					<strong>Net Pay:</strong> <span id="payslipNetPay">0.00</span><br>
				</div>

				<div class="mt-3">
					<strong>Received By:</strong> ________________________
				</div>
				<div class="mt-3 text-end">
					<strong>Approved By:</strong> Danver S. Reyes
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" id="nextCutoff">Next</button>
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary btn-print" data-modal="payslipModal">Print</button>
			</div>
		</div>
	</div>
</div>
=======
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
<!-- Pagination Controls -->
<div class="d-flex justify-content-between mt-3">
	<button id="prevPage" class="btn btn-secondary" disabled>Previous</button>
	<span id="pageInfo">Page 1</span>
	<button id="nextPage" class="btn btn-secondary">Next</button>
</div>

<script>
	document.addEventListener("DOMContentLoaded", function () {
		let currentPage = 0;
		const rowsPerPage = 7;
		const table = document.getElementById("employeeTable");
		const tbody = table.querySelector("tbody");
<<<<<<< HEAD
		const allRows = Array.from(tbody.rows);
=======
		let allRows = Array.from(tbody.rows);
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534
		let filteredRows = [...allRows];

		function totalPages() {
			return Math.ceil(filteredRows.length / rowsPerPage);
		}

		function showPage(page) {
			tbody.innerHTML = "";
			const start = (page - 1) * rowsPerPage;
			const end = start + rowsPerPage;
			filteredRows.slice(start, end).forEach(row => tbody.appendChild(row));
			document.getElementById("pageInfo").innerText = `Page ${page} of ${totalPages()}`;
			document.getElementById("prevPage").disabled = page === 1;
			document.getElementById("nextPage").disabled = page === totalPages();
		}

<<<<<<< HEAD
		document.getElementById("prevPage").addEventListener("click", function () {
			if (currentPage > 1) {
				currentPage--;
				showPage(currentPage);
			}
		});

		document.getElementById("nextPage").addEventListener("click", function () {
			if (currentPage < totalPages()) {
				currentPage++;
				showPage(currentPage);
			}
		});

		showPage(currentPage);
	});
</script>

<script>
=======
		function searchEmployee() {
			const searchInput = document.getElementById("searchInput").value.toLowerCase();
			filteredRows = allRows.filter(row =>
				Array.from(row.cells).some(cell => cell.innerText.toLowerCase().includes(searchInput))
			);
			currentPage = 1;
			showPage(currentPage);
		}

		document.getElementById("searchInput").addEventListener("keyup", searchEmployee);
		document.getElementById("prevPage").addEventListener("click", () => currentPage > 1 && showPage(--currentPage));
		document.getElementById("nextPage").addEventListener("click", () => currentPage < totalPages() && showPage(++currentPage));

		showPage(currentPage);
>>>>>>> e22e1ed1ca6da25fa1a49f57f5e7d6b63ff18534

		// Handle View Button Click (Event Delegation)
		document.getElementById("employeeTable").addEventListener("click", function (event) {
			if (event.target.classList.contains("btn-view")) {
				const row = event.target.closest("tr");
				const detailsTableBody = document.getElementById("detailsTableBody");

				detailsTableBody.innerHTML = `
					<tr><td>ID</td><td>${row.cells[0].innerText}</td></tr>
					<tr><td>Name</td><td>${row.cells[1].innerText}</td></tr>
					<tr><td>Department</td><td>${row.cells[2].innerText}</td></tr>
					<tr><td>Holiday</td><td>${row.cells[3].innerText}</td></tr>
					<tr><td>Overtime</td><td>${row.cells[4].innerText}</td></tr>
					<tr><td>Hours Worked</td><td>${row.cells[5].innerText}</td></tr>
				`;

				new bootstrap.Modal(document.getElementById("detailsModal")).show();
			}
		});

		// Handle File Upload & Sheet Selection
		document.getElementById("excelFileInput").addEventListener("change", function (event) {
			const file = event.target.files[0];
			if (file) {
				const formData = new FormData();
				formData.append("file", file);

				fetch("/Dashboard/GetSheets", { method: "POST", body: formData })
					.then(response => response.json())
					.then(data => {
						const sheetSelect = document.getElementById("sheetSelect");
						sheetSelect.innerHTML = '<option>Choose Sheet</option>';
						data.forEach(sheet => {
							const option = document.createElement("option");
							option.value = sheet;
							option.textContent = sheet;
							sheetSelect.appendChild(option);
						});
						sheetSelect.disabled = false;
					})
					.catch(error => console.error("Error fetching sheets:", error));
			}
		});

		document.getElementById("sheetSelect").addEventListener("change", function (event) {
			const sheetName = event.target.value;
			const file = document.getElementById("excelFileInput").files[0];

			if (file && sheetName) {
				const formData = new FormData();
				formData.append("file", file);
				formData.append("sheetName", sheetName);

				fetch("/Dashboard/GetData", { method: "POST", body: formData })
					.then(response => response.json())
					.then(data => {
						tbody.innerHTML = "";
						data.forEach(employee => {
							const row = document.createElement("tr");
							row.innerHTML = `
								<td>${employee.id}</td>
								<td><a href="#">${employee.name}</a></td>
								<td>${employee.department}</td>
								<td>${employee.holiday}</td>
								<td>${employee.overtime}</td>
								<td>${employee.hoursWorked}</td>
								<td>
									<button class="btn btn-primary btn-view">View</button>
									<button class="btn btn-danger btn-delete">Delete</button>
								</td>
							`;
							tbody.appendChild(row);
						});

						allRows = Array.from(tbody.rows);
						filteredRows = [...allRows];
						showPage(1);
					})
					.catch(error => console.error("Error fetching data:", error));
			}
		});
	});
</script>
